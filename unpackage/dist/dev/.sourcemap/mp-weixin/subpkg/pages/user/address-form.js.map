{"version":3,"file":"address-form.js","sources":["subpkg/pages/user/address-form.vue","D:/谷歌下载/HBuilderX.4.85.2025110510/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3VicGtnXHBhZ2VzXHVzZXJcYWRkcmVzcy1mb3JtLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"address-form-container\">\n\t\t<!-- 顶部导航栏 -->\n\t\t<view class=\"form-header\" :style=\"{ paddingTop: customNavBarHeight + 'px' }\">\n\t\t\t<view class=\"nav-back\" @click=\"goBack\">\n\t\t\t\t<img src=\"../../../static/arrow_logo.png\" alt=\"\" srcset=\"\" class=\"back-icon\" />\n\t\t\t</view>\n\t\t\t<text class=\"nav-title\">{{ isEdit ? '编辑地址' : '添加地址' }}</text>\n\t\t\t<view class=\"nav-save\" @click=\"saveAddress\">\n\t\t\t\t<text class=\"save-text\">保存</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 表单内容 -->\n\t\t<view class=\"form-content\">\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">收货人</text>\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tv-model=\"addressData.name\" \n\t\t\t\t\tclass=\"form-input\" \n\t\t\t\t\tplaceholder=\"请输入收货人姓名\"\n\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">手机号码</text>\n\t\t\t\t<input \n\t\t\t\t\ttype=\"number\" \n\t\t\t\t\tv-model=\"addressData.phone\" \n\t\t\t\t\tclass=\"form-input\" \n\t\t\t\t\tplaceholder=\"请输入手机号码\"\n\t\t\t\t\tmaxlength=\"11\"\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">省市区</text>\n\t\t\t\t<view class=\"region-selector\" @click=\"showRegionPicker\">\n\t\t\t\t\t<text class=\"region-text\" :class=\"{ placeholder: !regionText }\">\n\t\t\t\t\t\t{{ regionText || '请选择省市区' }}\n\t\t\t\t\t</text>\n\t\t\t\t\t<img src=\"../../../static/arrow.png\" alt=\"\" class=\"arrow-icon\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">详细地址</text>\n\t\t\t\t<textarea \n\t\t\t\t\tv-model=\"addressData.detail\" \n\t\t\t\t\tclass=\"form-textarea\" \n\t\t\t\t\tplaceholder=\"请输入详细地址信息，如道路、门牌号、小区、楼栋号、单元等信息\"\n\t\t\t\t\tmaxlength=\"100\"\n\t\t\t\t\tauto-height\n\t\t\t\t/>\n\t\t\t</view>\n\n\t\t\t<view class=\"form-item switch-item\">\n\t\t\t\t<text class=\"form-label\">设为默认地址</text>\n\t\t\t\t<switch \n\t\t\t\t\t:checked=\"addressData.isDefault\" \n\t\t\t\t\t@change=\"onDefaultChange\"\n\t\t\t\t\tcolor=\"#FF6B35\"\n\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 保存按钮 -->\n\t\t<view class=\"bottom-action\">\n\t\t\t<view class=\"save-btn\" @click=\"saveAddress\" :class=\"{ disabled: !canSave }\">\n\t\t\t\t<text>{{ isEdit ? '保存修改' : '保存地址' }}</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 省市区选择器 -->\n\t\t<up-picker \n\t\t\t:show=\"showPicker\" \n\t\t\t:columns=\"regionColumns\" \n\t\t\t@confirm=\"onRegionConfirm\"\n\t\t\t@cancel=\"onRegionCancel\"\n\t\t\tkeyName=\"name\"\n\t\t></up-picker>\n\t</view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\n\n// 自定义导航栏高度\nconst windowInfo = wx.getWindowInfo()\nconst menuButtonInfo = wx.getMenuButtonBoundingClientRect()\nconst customNavBarHeight = windowInfo.statusBarHeight + (menuButtonInfo.top - windowInfo.statusBarHeight)\n\n// 获取页面参数\nconst pages = getCurrentPages()\nconst currentPage = pages[pages.length - 1]\nconst options = currentPage.options || {}\n\n// 判断是否为编辑模式\nconst isEdit = ref(options.action === 'edit')\nconst editId = ref(options.id || '')\n\n// 地址数据\nconst addressData = ref({\n\tid: '',\n\tname: '',\n\tphone: '',\n\tprovince: '',\n\tcity: '',\n\tdistrict: '',\n\tdetail: '',\n\tisDefault: false\n})\n\n// 显示选择器\nconst showPicker = ref(false)\n\n// 省市区数据\nconst regionColumns = ref([\n\t// 省份数据\n\t[\n\t\t{ name: '北京市', code: '110000' },\n\t\t{ name: '上海市', code: '310000' },\n\t\t{ name: '广东省', code: '440000' },\n\t\t{ name: '浙江省', code: '330000' },\n\t\t{ name: '江苏省', code: '320000' }\n\t],\n\t// 城市数据\n\t[\n\t\t{ name: '北京市', code: '110100' },\n\t\t{ name: '上海市', code: '310100' },\n\t\t{ name: '广州市', code: '440100' },\n\t\t{ name: '深圳市', code: '440300' },\n\t\t{ name: '杭州市', code: '330100' }\n\t],\n\t// 区县数据\n\t[\n\t\t{ name: '朝阳区', code: '110105' },\n\t\t{ name: '海淀区', code: '110108' },\n\t\t{ name: '浦东新区', code: '310115' },\n\t\t{ name: '黄浦区', code: '310101' },\n\t\t{ name: '天河区', code: '440106' },\n\t\t{ name: '南山区', code: '440305' }\n\t]\n])\n\n// 计算显示的省市区文本\nconst regionText = computed(() => {\n\tif (addressData.value.province && addressData.value.city && addressData.value.district) {\n\t\treturn `${addressData.value.province} ${addressData.value.city} ${addressData.value.district}`\n\t}\n\treturn ''\n})\n\n// 是否可以保存\nconst canSave = computed(() => {\n\treturn addressData.value.name.trim() &&\n\t\t   addressData.value.phone.trim() &&\n\t\t   addressData.value.province &&\n\t\t   addressData.value.city &&\n\t\t   addressData.value.district &&\n\t\t   addressData.value.detail.trim()\n})\n\n// 获取地址详情（编辑时使用）\nconst getAddressDetail = () => {\n\tif (!isEdit.value) return\n\t\n\ttry {\n\t\tconst addressList = uni.getStorageSync('addressList') || []\n\t\tconst address = addressList.find(item => item.id === editId.value)\n\t\t\n\t\tif (address) {\n\t\t\taddressData.value = { ...address }\n\t\t}\n\t} catch (e) {\n\t\tconsole.error('获取地址详情失败:', e)\n\t}\n}\n\n// 显示省市区选择器\nconst showRegionPicker = () => {\n\tshowPicker.value = true\n}\n\n// 确认选择省市区\nconst onRegionConfirm = (e) => {\n\tconst [province, city, district] = e.value\n\taddressData.value.province = province.name\n\taddressData.value.city = city.name\n\taddressData.value.district = district.name\n\tshowPicker.value = false\n}\n\n// 取消选择省市区\nconst onRegionCancel = () => {\n\tshowPicker.value = false\n}\n\n// 切换默认地址\nconst onDefaultChange = (e) => {\n\taddressData.value.isDefault = e.detail.value\n}\n\n// 保存地址\nconst saveAddress = () => {\n\tif (!canSave.value) {\n\t\tuni.showToast({\n\t\t\ttitle: '请填写完整信息',\n\t\t\ticon: 'none'\n\t\t})\n\t\treturn\n\t}\n\n\t// 验证手机号\n\tif (!/^1[3-9]\\d{9}$/.test(addressData.value.phone)) {\n\t\tuni.showToast({\n\t\t\ttitle: '请输入正确的手机号',\n\t\t\ticon: 'none'\n\t\t})\n\t\treturn\n\t}\n\n\ttry {\n\t\tlet addressList = uni.getStorageSync('addressList') || []\n\t\t\n\t\tif (isEdit.value) {\n\t\t\t// 编辑模式\n\t\t\tconst index = addressList.findIndex(item => item.id === editId.value)\n\t\t\tif (index !== -1) {\n\t\t\t\t// 如果设为默认地址，先将其他地址设为非默认\n\t\t\t\tif (addressData.value.isDefault) {\n\t\t\t\t\taddressList.forEach(item => {\n\t\t\t\t\t\titem.isDefault = false\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\taddressList[index] = { ...addressData.value }\n\t\t\t}\n\t\t} else {\n\t\t\t// 添加模式\n\t\t\tconst newAddress = {\n\t\t\t\t...addressData.value,\n\t\t\t\tid: Date.now().toString()\n\t\t\t}\n\t\t\t\n\t\t\t// 如果设为默认地址，先将其他地址设为非默认\n\t\t\tif (newAddress.isDefault) {\n\t\t\t\taddressList.forEach(item => {\n\t\t\t\t\titem.isDefault = false\n\t\t\t\t})\n\t\t\t}\n\t\t\t\n\t\t\taddressList.unshift(newAddress)\n\t\t}\n\t\t\n\t\tuni.setStorageSync('addressList', addressList)\n\t\t\n\t\tuni.showToast({\n\t\t\ttitle: isEdit.value ? '修改成功' : '添加成功',\n\t\t\ticon: 'success'\n\t\t})\n\t\t\n\t\t// 返回上一页\n\t\tsetTimeout(() => {\n\t\t\tuni.navigateBack()\n\t\t}, 1500)\n\t\t\n\t} catch (e) {\n\t\tconsole.error('保存地址失败:', e)\n\t\tuni.showToast({\n\t\t\ttitle: '保存失败，请重试',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n}\n\n// 返回上一页\nconst goBack = () => {\n\tuni.navigateBack({\n\t\tdelta: 1\n\t})\n}\n\n// 页面加载时初始化数据\nonMounted(() => {\n\tgetAddressDetail()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.address-form-container {\n\tmin-height: 100vh;\n\tbackground: #f5f5f5;\n\tpadding-bottom: 120rpx;\n}\n\n// 顶部导航栏\n.form-header {\n\tbackground: #fff;\n\tpadding: 0 32rpx;\n\tpadding-bottom: 20rpx;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n\tposition: sticky;\n\ttop: 0;\n\tz-index: 100;\n\n\t.nav-back {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: rgba(0, 0, 0, 0.05);\n\t\tborder-radius: 30rpx;\n\n\t\t.back-icon {\n\t\t\twidth: 32rpx;\n\t\t\theight: 32rpx;\n\t\t}\n\t}\n\n\t.nav-title {\n\t\tfont-size: 36rpx;\n\t\tfont-weight: 600;\n\t\tcolor: #000;\n\t}\n\n\t.nav-save {\n\t\t.save-text {\n\t\t\tfont-size: 32rpx;\n\t\t\tcolor: #FF6B35;\n\t\t\tfont-weight: 600;\n\t\t}\n\t}\n}\n\n// 表单内容\n.form-content {\n\tpadding: 20rpx 32rpx;\n\n\t.form-item {\n\t\tbackground: #fff;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tborder-radius: 16rpx;\n\n\t\t&.switch-item {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.form-label {\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #333;\n\t\t\tfont-weight: 500;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\tdisplay: block;\n\t\t}\n\n\t\t.form-input {\n\t\t\twidth: 100%;\n\t\t\theight: 80rpx;\n\t\t\tbackground: #f8f8f8;\n\t\t\tborder-radius: 12rpx;\n\t\t\tpadding: 0 24rpx;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #333;\n\t\t\tbox-sizing: border-box;\n\t\t}\n\n\t\t.form-textarea {\n\t\t\twidth: 100%;\n\t\t\tmin-height: 120rpx;\n\t\t\tbackground: #f8f8f8;\n\t\t\tborder-radius: 12rpx;\n\t\t\tpadding: 24rpx;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor: #333;\n\t\t\tline-height: 1.5;\n\t\t\tbox-sizing: border-box;\n\t\t}\n\n\t\t.region-selector {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: space-between;\n\t\t\tbackground: #f8f8f8;\n\t\t\tborder-radius: 12rpx;\n\t\t\tpadding: 24rpx;\n\t\t\tmin-height: 80rpx;\n\n\t\t\t.region-text {\n\t\t\t\tfont-size: 28rpx;\n\t\t\t\tcolor: #333;\n\t\t\t\tflex: 1;\n\n\t\t\t\t&.placeholder {\n\t\t\t\t\tcolor: #999;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.arrow-icon {\n\t\t\t\twidth: 24rpx;\n\t\t\t\theight: 24rpx;\n\t\t\t\topacity: 0.6;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// 底部保存按钮\n.bottom-action {\n\tposition: fixed;\n\tbottom: 0;\n\tleft: 0;\n\tright: 0;\n\tbackground: #fff;\n\tpadding: 20rpx 32rpx;\n\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);\n\tz-index: 100;\n\n\t.save-btn {\n\t\twidth: 100%;\n\t\tbackground: #FF6B35;\n\t\tcolor: #fff;\n\t\tpadding: 24rpx;\n\t\tborder-radius: 50rpx;\n\t\ttext-align: center;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 600;\n\n\t\t&.disabled {\n\t\t\tbackground: #ccc;\n\t\t\tcolor: #999;\n\t\t}\n\t}\n}\n</style>","import MiniProgramPage from 'F:/v3/admin-app/subpkg/pages/user/address-form.vue'\nwx.createPage(MiniProgramPage)"],"names":["wx","ref","computed","uni","onMounted"],"mappings":"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"}